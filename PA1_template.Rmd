---
title: "Reproducible Research: Peer Assessment 1"
output: 
  html_document:
    keep_md: true
    toc: true
    toc_depth: 3
    theme: default
---

```{r setoptions, echo=FALSE}
# Disable scientific notation of large numbers. 
options("scipen"=15)

```

## Loading and preprocessing the data
### Setup the data files
First, establish some settings regarding where the data is located:
```{r}
url = "https://d396qusza40orc.cloudfront.net/repdata%2Fdata%2Factivity.zip"
zipFile = "activity.zip"
dataDirectory = "data"
dataFile = "activity.csv"
```

Then, perform data caching. Check if the required data is already stored in the 
working directory. If the data has already been extracted into the "data" 
directory as a csv file, then nothing needs to be done at this stage. If the 
data esists only as a zip file in the working directory, then extract the data 
into a csv file. And if the data is not present at all, download and extract 
the data automatically from the source URL. 
```{r}
# Checks if the csv data exists
dataFilePath = paste(dataDirectory, dataFile, sep="/")
if(!file.exists(dataFilePath)){
    # Create the data directory if not already present
    if(!file.exists(dataDirectory)){
        dir.create(dataDirectory)
    }
    # Download the zip file from URL if its not already in working directory
    if (!file.exists(zipFile)) {
        download.file(url, destfile = zipFile, mode="wb")
    }
    # unzip the contents of the zip file into data directory
    unzip(zipFile, exdir=dataDirectory)
}
```

### Loading the data
Since it has now been established that the data exists in the data directory, we 
can load it into a data frame. 
```{r}
df = read.csv(dataFilePath)
```

### Preprocess the data
The data contains lots of missing values which interfere and skew the data, 
creating a disproportionate number of false zeroes if not removed. So all rows 
containing missing data are removed here at this early stage. 
```{r}
df = df[complete.cases(df),]
```

The data also contains a date field, so we need to convert the items in that 
column to be date objects instead of strings. 

```{r}
dateFormat = "%Y-%m-%d"
df$date = as.Date(df$date, dateFormat)
```

## What is mean total number of steps taken per day?
### Visualising frequency of total daily steps
A histogram is plotted to give us an idea of how the frequencies for different 
number of steps are distributed. 
```{r message=FALSE}
library(dplyr)

df.StepsPerDay <- summarise(group_by(df, date), total.steps=sum(steps, na.rm=TRUE))
hist(df.StepsPerDay$total.steps, breaks=20, col="red", 
     xlab="Total Number of Steps Per Day",
     main="Frequencies of Total Number of Steps Per Day")
```

A value of 20 breaks reveals regions which may 
be skewing the data. If the rows with missing data had not been removed earlier, 
then we would see a large spike in the frequency for zero steps. This spike 
occurs even when the ```na.rm=TRUE``` option is used in the ```sum()``` and 
```mean()``` functions. This is because ```sum()``` returns 0 if it is asked to 
sum over a vector composed exclusively of NAs. So by the time the ```mean()``` 
function is called, any values which should have been NAs are now zeroes, and 
```mean()``` does not (and should not) filter out zeroes.

A smaller number of breaks would hide the presence of such a problematic peak 
from our view, due to the very small frequencies for steps higher than 0 but 
less than 5000. 

### Mean and median of total daily steps
We can find out what the mean and median number of total daily steps is. 
```{r}
mean.dailySteps <- mean(df.StepsPerDay$total.steps, na.rm=TRUE)
median.dailySteps <- median(df.StepsPerDay$total.steps, na.rm=TRUE)
```

```{r}
mean.dailySteps
median.dailySteps
```

We find that the mean number of total daily steps is 
**`r round(mean.dailySteps, digits=2)`** and the median number of total daily steps 
is **`r round(median.dailySteps, digits=2)`**. Both values are very close together, 
meaning that both are good measures of centrality for this data.


## What is the average daily activity pattern?



## Imputing missing values



## Are there differences in activity patterns between weekdays and weekends?
